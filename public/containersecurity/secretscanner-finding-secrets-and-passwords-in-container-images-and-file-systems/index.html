<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Demestifying Container and Orchestration Ecosystem">
<meta name="author" content="CloudNativeFolks">

<title>SecretScanner - Finding secrets and passwords in container images and file systems ¬∑ kubedaily</title>

<link rel="canonical" href="https://kubedaily.com/containersecurity/secretscanner-finding-secrets-and-passwords-in-container-images-and-file-systems/">









<link rel="stylesheet" href="/scss/base.css" integrity="">



<link rel="stylesheet" href="/scss/theme/default.css" integrity="">



  <link rel="preconnect" href="https://-dsn.algolia.net" crossorigin />
  
  <link rel="stylesheet" href="/scss/component/docsearch.css" integrity=""/>

<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/img/icon/favicon.ico">
<link rel="icon" href="/img/icon/icon-16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/img/icon/icon-32.png" sizes="32x32" type="image/png">
<link rel="apple-touch-icon" href="/img/icon/icon-180.png" sizes="180x180">
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', '');
</script>
    <script 
     src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/quizdown.js">
  </script>
  <script 
      src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/extensions/quizdownKatex.js">
  </script>
  <script 
      src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/extensions/quizdownHighlight.js">
  </script>
  <script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
  </head>
  <body>
    <header id="site-header">
  
  <div id="site-header-brand">
    <a href="/">kubedaily</a>
  </div>

  
  <div id="site-header-controls">
    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="theme selector">
        <i class="icon icon-brightness"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        <li role="menuitem"><button class="color-scheme" data-value="light"><i class="icon icon-light-mode"></i> Light</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="dark"><i class="icon icon-dark-mode"></i> Dark &nbsp;</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="night"><i class="icon icon-night-mode"></i> Night</button></li>
      </ul>
    </div>

    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="language selector">
        <i class="icon icon-translate"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        
          <li role="menuitem"><a href="#">English</a></li>
        
      </ul>
    </div>
  </div>

  
  <div id="site-header-menu">
    <nav>
      <ul>
        
        
        
          
          <li><a href="/" ><i class='icon icon-home'></i>Home</a></li>
        
          
          <li><a href="/docker/" ><i class='icon icons8-docker '></i>Docker</a></li>
        
          
          <li><a href="/containersecurity/"  class="active"><i class='icon icon-book'></i>ContainerSecurity</a></li>
        
          
          <li><a href="/k8s/" ><i class='icon icons8-kubernetes'></i>Kubernetes</a></li>
        
          
          <li><a href="/blog/" ><i class='icon icon-book'></i>blog</a></li>
        
          
          <li><a href="https://kubedaily.com/cloudnativetools/" ><i class='icon icon-book'></i>cloudnativetools</a></li>
        
      </ul>
    </nav>
  </div>

  

</header>
    
<div id="site-main-content-wrapper">
  
  
    <aside id="sidebar">
  <span class="btn-close"><i class="icon icon-close"></i></span>

  <div class="sticky"><strong class="sidebar-section">Container Security</strong>
          
          <a class="sidebar-link " href="/containersecurity/overview/">
            
              Overview
            
          </a>

        <strong class="sidebar-section">üîíContainerSecurity</strong>
          
          <a class="sidebar-link " href="/containersecurity/what-is-container/">
            
              What is container?
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/container-vs-virtualization/">
            
              Container vs Virtualization
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/namespaces/">
            
              Namespaces
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/cgroups/">
            
              Cgroups
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/capabilities/">
            
              Capabilities
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-architecture-and-its-components/">
            
              Docker architecture and its components
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/interacting-with-container-ecosystem/">
            
              Interacting with container ecosystem
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/attack-surface-of-the-container-ecosystem/">
            
              Attack surface of the container ecosystem
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-volumes/">
            
              Docker volumes
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-networking/">
            
              Docker Networking
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/auditing-docker-security/">
            
              Auditing Docker Security
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/container-image-security/">
            
              Container Image Security
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/dockerfile-security-best-practices/">
            
              DockerFile Security Best Practices
            
          </a>

        
          
          <a class="sidebar-link current" href="/containersecurity/secretscanner-finding-secrets-and-passwords-in-container-images-and-file-systems/">
            
              SecretScanner - Finding secrets and passwords in container images and file systems
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/yarahunter-malware-scanner-for-container-images/">
            
              YaraHunter - Malware Scanner for Container Images
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/security-linting-of-dockerfiles/">
            
              Security Linting of Dockerfiles
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/static-analysis-of-container-images-library-for-container/">
            
              Static Analysis of container images library for container
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-host-security-configurations/">
            
              Docker host security configurations
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-daemon-security-configurations/">
            
              Docker Daemon security configurations
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/content-trust-and-integrity-checks/">
            
              Content Trust and Integrity checks
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-registry-security-configurations/">
            
              Docker Registry security configurations
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/dockerscan/">
            
              DockerScan
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/dive/">
            
              Dive
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-events/">
            
              Docker events
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity//">
            
              
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity//">
            
              
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity//">
            
              
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity//">
            
              
            
          </a>

        
  </div>
</aside>
  
  <main>
    <article id="article">
      <nav id="article-nav">
  <button id="article-nav-menu-btn"><i class="icon icon-menu"></i> On this section</button>
  <button id="article-nav-toc-btn"><i class="icon icon-toc"></i> On this page</button>
</nav>
      <header id="article-header">
  <h1>SecretScanner - Finding secrets and passwords in container images and file systems</h1>
</header>
      <div id="article-content">
        
        
        <p>Published on <a href="https://blog.cloudnativefolks.org/finding-leaked-secrets-in-your-container-images-and-file-system-with-secretscanner" target="_blank">CloudNativeFolks</a></p>
<p>One of most common mistake is leaking Secrets via docker images or file system in this blogpost we will use <a href="https://deepfence.io">Deepfence&rsquo;s</a> Open Source Project <a href="https://github.com/deepfence/SecretScanner" target="_blank">SecretScanner</a></p>
<p>few days back I found this interesting tweet discussion from cybersecurity community members !</p>
<!-- raw HTML omitted -->
<p>here you see article around Uber security incidence</p>
<p>%[https://www.uber.com/newsroom/security-update/]</p>
<p>lets understand why secret scanner help you securing your container images and file system</p>
<p>If you see DockerHub most of images and public and thousands of secrets leaked over the year</p>
<p>If you see of of example from past supply chain attack one of docker image Codecov contain git credentials that allow attacker to gain access to price Codecov&rsquo;s private git repositories and committed backdoors by attacker to there product and later that effected to 22000 Codecov&rsquo;s users</p>
<h2 id="lets-write-insecuredockerfile">lets write <code>insecure.DockerFile</code></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">FROM python:3.9-slim
</span></span><span class="line"><span class="cl">ENV DATABASE_PASSWORD &#34;SuperSecret&#34;
</span></span></code></pre></div><h2 id="dont-store-secrets-in-images">Don&rsquo;t Store Secrets in Images</h2>
<p>Secrets are sensitive pieces of information such as passwords, database credentials, SSH keys, tokens, and TLS certificates, to name a few. These should not be baked into your images without being encrypted since unauthorized users who gain access to the image can merely examine the layers to extract the secrets.</p>
<p>Instead, they should be injected via:</p>
<ul>
<li>
<p>Environment variables (at run-time)</p>
</li>
<li>
<p>Build-time arguments (at build-time)</p>
</li>
<li>
<p>An orchestration tool like Docker Swarm (via Docker secrets) or Kubernetes (via Kubernetes secrets)</p>
</li>
<li>
<p>Also, you can help prevent leaking secrets by adding common secret files and folders to your .dockerignore file:</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">**/.env
</span></span><span class="line"><span class="cl">**/.aws
</span></span><span class="line"><span class="cl">**/.ssh
</span></span></code></pre></div><p>be explicit about what files are getting copied over to the image rather than copying all files recursively:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"># BAD
</span></span><span class="line"><span class="cl">COPY . .
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># GOOD
</span></span><span class="line"><span class="cl">copy ./app.py .
</span></span></code></pre></div><h2 id="environment-variables">Environment Variables</h2>
<p>You can pass secrets via environment variables, but they will be visible in all child processes, linked containers, and logs, as well as via docker inspect. It&rsquo;s also difficult to update them.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">$ docker run --detach --env &#34;DATABASE_PASSWORD=SuperSecret&#34; python:3.9-slim
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">d92cf5cf870eb0fdbf03c666e7fcf18f9664314b79ad58bc7618ea3445e39239
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ docker inspect --format=&#39;{{range .Config.Env}}{{println .}}{{end}}&#39; d92cf5cf870eb0fdbf03c666e7fcf18f9664314b79ad58bc7618ea3445e39239
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DATABASE_PASSWORD=SuperSecret
</span></span><span class="line"><span class="cl">PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</span></span><span class="line"><span class="cl">LANG=C.UTF-8
</span></span><span class="line"><span class="cl">GPG_KEY=E3FF2839C048B25C084DEBE9B26995E310250568
</span></span><span class="line"><span class="cl">PYTHON_VERSION=3.9.7
</span></span><span class="line"><span class="cl">PYTHON_PIP_VERSION=21.2.4
</span></span><span class="line"><span class="cl">PYTHON_SETUPTOOLS_VERSION=57.5.0
</span></span><span class="line"><span class="cl">PYTHON_GET_PIP_URL=https://github.com/pypa/get-pip/raw/c20b0cfd643cd4a19246ccf204e2997af70f6b21/public/get-pip.py
</span></span><span class="line"><span class="cl">PYTHON_GET_PIP_SHA256=fa6f3fb93cce234cd4e8dd2beb54a51ab9c247653b52855a48dd44e6b21ff28b
</span></span></code></pre></div><h2 id="build-time-arguments">Build-time Arguments</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker build --build-arg &#34;DATABASE_PASSWORD=SuperSecret&#34; .
</span></span></code></pre></div><p>rather then build time arguments you can use Multi-stage build so <code>docker history</code> will be ignored . The multi-stage build only retains the history for the final image. Keep in mind that you can use this functionality for permanent secrets that you need for your application, like a database credential.</p>
<p>You can also use the &ndash;secret option in Docker build to pass secrets to Docker images that do not get stored in the images.</p>
<p>refer create secret doc [https://docs.docker.com/engine/reference/commandline/secret_create/ ] ```</p>
<h1 id="docker-gt-secretstxt">&ldquo;docker&rdquo; &gt; secrets.txt</h1>
<p>FROM alpine</p>
<h1 id="shows-secret-from-default-secret-location">shows secret from default secret location:</h1>
<p>RUN &ndash;mount=type=secret,id=mysecret cat /run/secrets/mysecret</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">This will mount the secret from the secrets.txt file.
</span></span></code></pre></div><p>docker build &ndash;no-cache &ndash;progress=plain &ndash;secret id=mysecret,src=secrets.txt .</p>
<h1 id="output">output</h1>
<p>&hellip; #4 [1/2] FROM docker.io/library/alpine #4 sha256:665ba8b2cdc0cb0200e2a42a6b3c0f8f684089f4cd1b81494fbb9805879120f7 #4 CACHED</p>
<p>#5 [2/2] RUN &ndash;mount=type=secret,id=mysecret cat /run/secrets/mysecret #5 sha256:75601a522ebe80ada66dedd9dd86772ca932d30d7e1b11bba94c04aa55c237de #5 0.635 docker #5 DONE 0.7s</p>
<h1 id="exporting-to-image">exporting to image</h1>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">lets see the leaked secret
</span></span></code></pre></div><p><code>‚ùØ docker history 49574a19241c IMAGE CREATED CREATED BY SIZE COMMENT 49574a19241c 5 minutes ago CMD \[&quot;/bin/sh&quot;\] 0B buildkit.dockerfile.v0 5 minutes ago RUN /bin/sh -c cat /run/secrets/mysecret # b‚Ä¶ 0B buildkit.dockerfile.v0 4 weeks ago /bin/sh -c #(nop) CMD \[&quot;/bin/sh&quot;\] 0B 4 weeks ago /bin/sh -c #(nop) ADD file:aad4290d27580cc1a‚Ä¶ 5.6MB </code></p>
<p>but most modern way to scan docker images and file system you can use open source tool secretscanner that make developer life easy to detect leaked secretes</p>
<p>pull latest secretscanner image</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker pull deepfenceio/deepfence_secret_scanner:latest
</span></span></code></pre></div><p>Pull docker image that you want to scan</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">docker pull node:8.11
</span></span></code></pre></div><p>Hund Secrets</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">docker run -it --rm --name=deepfence-secretscanner -v $(pwd):/home/deepfence/output -v /var/run/docker.sock:/var/run/docker.sock deepfenceio/deepfence_secret_scanner:latest -image-name node:8.11
</span></span></code></pre></div><p>output</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">Scanning image /tmp/Deepfence/SecretScanning/df_node811/save-output.tar for secrets...
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 85,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Potential Linux passwd file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;path&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;etc/passwd$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 10,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;etc/passwd&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;etc/passwd&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 69,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Shell profile configuration file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;filename&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;^\\.?(bash_|zsh_)?profile$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 7,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;etc/profile&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;profile&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 84,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Potential Linux shadow file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;path&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;etc/shadow$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 10,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;etc/shadow&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;etc/shadow&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 68,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Shell configuration file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;filename&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;^\\.?(bash|zsh|csh)rc$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 7,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;etc/skel/.bashrc&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;.bashrc&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 69,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Shell profile configuration file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;filename&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;^\\.?(bash_|zsh_)?profile$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 8,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;etc/skel/.profile&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;.profile&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 68,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Shell configuration file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;filename&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;^\\.?(bash|zsh|csh)rc$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 7,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;root/.bashrc&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;.bashrc&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 69,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Shell profile configuration file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;filename&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;^\\.?(bash_|zsh_)?profile$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 8,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;root/.profile&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;.profile&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 88,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Environment configuration file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;filename&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;^\\.?env$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 3,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;usr/bin/env&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;env&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 69,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Shell profile configuration file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;filename&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;^\\.?(bash_|zsh_)?profile$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 7,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;usr/share/base-files/profile&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;profile&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;23d81b1ef111d5b6cec4559da8d7ad53f9ce5314134c9a232ecbb050b0269f76&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 69,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Shell profile configuration file&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;filename&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;^\\.?(bash_|zsh_)?profile$&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;medium&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 5.00,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 7,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;usr/share/doc/adduser/examples/adduser.local.conf.examples/profile&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;profile&#34;
</span></span><span class="line"><span class="cl">    },
</span></span><span class="line"><span class="cl">    {
</span></span><span class="line"><span class="cl">      &#34;Image Layer ID&#34;: &#34;45475acd15f3bb8a3b04367eda1a2553d6b18d95723eb51737bc9d9a24227336&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule ID&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Matched Rule Name&#34;: &#34;Potential cryptographic private key&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Part&#34;: &#34;extension&#34;,
</span></span><span class="line"><span class="cl">      &#34;String to Match&#34;: &#34;.pem&#34;,
</span></span><span class="line"><span class="cl">      &#34;Signature to Match&#34;: &#34;&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity&#34;: &#34;low&#34;,
</span></span><span class="line"><span class="cl">      &#34;Severity Score&#34;: 2.50,
</span></span><span class="line"><span class="cl">      &#34;Starting Index of Match in Original Content&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Starting Index of Match in Displayed Substring&#34;: 0,
</span></span><span class="line"><span class="cl">      &#34;Relative Ending Index of Match in Displayed Substring&#34;: 4,
</span></span><span class="line"><span class="cl">      &#34;Full File Name&#34;: &#34;etc/ssl/certs/ACCVRAIZ1.pem&#34;,
</span></span><span class="line"><span class="cl">      &#34;Matched Contents&#34;: &#34;.pem&#34;
</span></span><span class="line"><span class="cl">    }
</span></span></code></pre></div><p>if you see about scan report its provide <code>Image Layer ID</code> and <code>Matched Rule Name</code> that describe about type of secret its detect also its provide <code>&quot;Severity&quot;: &quot;type&quot;, &quot;Severity Score&quot;: 2.50</code>, with <code>&quot;Matched Contents&quot;: &quot;&lt;contenttype&quot;&gt;</code></p>
<h2 id="use-dockerignore-file">use .dockerignore file</h2>
<p>What should you add to the .dockerignore file?</p>
<ul>
<li>
<p>Temporary files and folders</p>
</li>
<li>
<p>Build logs</p>
</li>
<li>
<p>Local secrets</p>
</li>
<li>
<p>Local development files like docker-compose.yml</p>
</li>
<li>
<p>Version control folders like &ldquo;.git&rdquo;, &ldquo;.hg&rdquo;, and &ldquo;.svn&rdquo; Example:</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">**/.git
</span></span><span class="line"><span class="cl">**/.gitignore
</span></span><span class="line"><span class="cl">**/.vscode
</span></span><span class="line"><span class="cl">**/coverage
</span></span><span class="line"><span class="cl">**/.env
</span></span><span class="line"><span class="cl">**/.aws
</span></span><span class="line"><span class="cl">**/.ssh
</span></span><span class="line"><span class="cl">Dockerfile
</span></span><span class="line"><span class="cl">README.md
</span></span><span class="line"><span class="cl">docker-compose.yml
</span></span><span class="line"><span class="cl">**/.DS_Store
</span></span><span class="line"><span class="cl">**/venv
</span></span><span class="line"><span class="cl">**/env
</span></span></code></pre></div><p>Check it out SecretScanner and support this project by giving gitstar !</p>
<p><a href="https://github.com/deepfence/SecretScanner"><img src="https://github-readme-stats.vercel.app/api/pin/?username=deepfence&amp;repo=SecretScanner" alt="Readme Card" target="_blank"></a></p>

      </div>
      








  
  
  
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

      
    
        

        
          
        

        
        


<footer id="article-footer">
  <time id="article-last-updated" datetime="2023-12-04"><i class="icon icon-calendar"></i>&nbsp;Last updated: 2023-12-04</time>

  
    <a id="article-prev-link" href="/containersecurity/dockerfile-security-best-practices/"><i class="icon icon-prev icon-colored"></i> Prev</a>
  

  
    <a id="article-next-link"  href="/containersecurity/yarahunter-malware-scanner-for-container-images/">Next <i class="icon icon-next icon-colored"></i></a>
  
</footer>
    </article>
    <aside id="toc">
  <span class="btn-close"><i class="icon icon-close"></i></span>
  <div class="sticky">
    <strong><i class="icon icon-toc"></i> On this page</strong>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#lets-write-insecuredockerfile">lets write <code>insecure.DockerFile</code></a></li>
    <li><a href="#dont-store-secrets-in-images">Don&rsquo;t Store Secrets in Images</a></li>
    <li><a href="#environment-variables">Environment Variables</a></li>
    <li><a href="#build-time-arguments">Build-time Arguments</a></li>
  </ul>

  <ul>
    <li><a href="#use-dockerignore-file">use .dockerignore file</a></li>
  </ul>
</nav>
  </div>
</aside>
  </main>
</div>

    <footer id="site-footer">
  
  <div id="site-footer-copyright">
    <a href="https://discord.gg/rEvr7vq" target="_blank">
      <i class="icon icon-copyright"></i> 2023 CloudNativeFolks
    </a>
  </div>

  
  <div id="site-footer-social">

    

    
    <a href="https://twitter.com/i/communities/1499311438745468931" target="_blank" aria-label="twitter url">
      <i class="icon icon-twitter icon-colored"></i>
    </a>
    

    
    <a href="https://github.com/sangam14" target="_blank" aria-label="github url">
      <i class="icon icon-github icon-colored"></i>
    </a>
    

    
    <a href="https://www.youtube.com/@CloudNativeFolks" target="_blank" aria-label="youtube url">
      <i class="icon icon-youtube icon-colored"></i>
    </a>
    

  </div>

  
  <center> <a href="https://visitorbadge.io/status?path=https%3A%2F%2Fkubedaily.com"><img src="https://api.visitorbadge.io/api/visitors?path=https%3A%2F%2Fkubedaily.com&label=KubeDaily&labelColor=%232ccce4&countColor=%2337d67a" /></a> </center> 

  
  <div id="site-footer-love">
    Made with <i class="icon icon-love icon-colored"></i> &nbsp;from&nbsp;<a href="https://blog.cloudnativefolks.org" target="_blank">@CloudNativeFollks</a>
  </div>
</footer>
    






<script type="text/javascript" src="/js/base.min.js"></script>



  
  <script src="/js/component/docsearch.min.js"></script>
  <script type="application/javascript">
      docsearch({
          container: '#site-header-search',
          appId: '',
          indexName: '',
          apiKey: '',
      });
  </script>


<script type="application/javascript">
    if('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js?2023-12-06')
            .catch(function(err) {console.error('ServiceWorker registration failed: ', err);});
    }
</script>
  </body>
</html>