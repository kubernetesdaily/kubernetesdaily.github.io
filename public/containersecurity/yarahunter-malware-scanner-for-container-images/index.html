<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Demestifying Container and Orchestration Ecosystem">
<meta name="author" content="CloudNativeFolks">

<title>YaraHunter - Malware Scanner for Container Images ¬∑ kubedaily</title>

<link rel="canonical" href="https://kubedaily.com/containersecurity/yarahunter-malware-scanner-for-container-images/">









<link rel="stylesheet" href="/scss/base.css" integrity="">



<link rel="stylesheet" href="/scss/theme/default.css" integrity="">



  <link rel="preconnect" href="https://-dsn.algolia.net" crossorigin />
  
  <link rel="stylesheet" href="/scss/component/docsearch.css" integrity=""/>

<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/img/icon/favicon.ico">
<link rel="icon" href="/img/icon/icon-16.png" sizes="16x16" type="image/png">
<link rel="icon" href="/img/icon/icon-32.png" sizes="32x32" type="image/png">
<link rel="apple-touch-icon" href="/img/icon/icon-180.png" sizes="180x180">
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', '');
</script>
    <script 
     src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/quizdown.js">
  </script>
  <script 
      src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/extensions/quizdownKatex.js">
  </script>
  <script 
      src="https://cdn.jsdelivr.net/npm/quizdown@latest/public/build/extensions/quizdownHighlight.js">
  </script>
  <script>quizdown.register(quizdownHighlight).register(quizdownKatex).init()</script> 
  </head>
  <body>
    <header id="site-header">
  
  <div id="site-header-brand">
    <a href="/">kubedaily</a>
  </div>

  
  <div id="site-header-controls">
    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="theme selector">
        <i class="icon icon-brightness"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        <li role="menuitem"><button class="color-scheme" data-value="light"><i class="icon icon-light-mode"></i> Light</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="dark"><i class="icon icon-dark-mode"></i> Dark &nbsp;</button></li>
        <li role="menuitem"><button class="color-scheme" data-value="night"><i class="icon icon-night-mode"></i> Night</button></li>
      </ul>
    </div>

    
    <div class="dropdown">
      <button class="dropdown-btn" aria-haspopup="menu" aria-label="language selector">
        <i class="icon icon-translate"></i>
        <i class="icon icon-select"></i>
      </button>
      <ul role="menu" class="dropdown-menu">
        
          <li role="menuitem"><a href="#">English</a></li>
        
      </ul>
    </div>
  </div>

  
  <div id="site-header-menu">
    <nav>
      <ul>
        
        
        
          
          <li><a href="/" ><i class='icon icon-home'></i>Home</a></li>
        
          
          <li><a href="/docker/" ><i class='icon icons8-docker '></i>Docker</a></li>
        
          
          <li><a href="/containersecurity/"  class="active"><i class='icon icon-book'></i>ContainerSecurity</a></li>
        
          
          <li><a href="/k8s/" ><i class='icon icons8-kubernetes'></i>Kubernetes</a></li>
        
          
          <li><a href="/blog/" ><i class='icon icon-book'></i>blog</a></li>
        
          
          <li><a href="https://kubedaily.com/cloudnativetools/" ><i class='icon icon-book'></i>cloudnativetools</a></li>
        
      </ul>
    </nav>
  </div>

  

</header>
    
<div id="site-main-content-wrapper">
  
  
    <aside id="sidebar">
  <span class="btn-close"><i class="icon icon-close"></i></span>

  <div class="sticky"><strong class="sidebar-section">Container Security</strong>
          
          <a class="sidebar-link " href="/containersecurity/overview/">
            
              Overview
            
          </a>

        <strong class="sidebar-section">üîíContainerSecurity</strong>
          
          <a class="sidebar-link " href="/containersecurity/what-is-container/">
            
              What is container?
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/container-vs-virtualization/">
            
              Container vs Virtualization
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/namespaces/">
            
              Namespaces
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/cgroups/">
            
              Cgroups
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/capabilities/">
            
              Capabilities
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-architecture-and-its-components/">
            
              Docker architecture and its components
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/interacting-with-container-ecosystem/">
            
              Interacting with container ecosystem
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/attack-surface-of-the-container-ecosystem/">
            
              Attack surface of the container ecosystem
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-volumes/">
            
              Docker volumes
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-networking/">
            
              Docker Networking
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/auditing-docker-security/">
            
              Auditing Docker Security
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/container-image-security/">
            
              Container Image Security
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/dockerfile-security-best-practices/">
            
              DockerFile Security Best Practices
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/secretscanner-finding-secrets-and-passwords-in-container-images-and-file-systems/">
            
              SecretScanner - Finding secrets and passwords in container images and file systems
            
          </a>

        
          
          <a class="sidebar-link current" href="/containersecurity/yarahunter-malware-scanner-for-container-images/">
            
              YaraHunter - Malware Scanner for Container Images
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/security-linting-of-dockerfiles/">
            
              Security Linting of Dockerfiles
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/static-analysis-of-container-images-library-for-container/">
            
              Static Analysis of container images library for container
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-host-security-configurations/">
            
              Docker host security configurations
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-daemon-security-configurations/">
            
              Docker Daemon security configurations
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/content-trust-and-integrity-checks/">
            
              Content Trust and Integrity checks
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-registry-security-configurations/">
            
              Docker Registry security configurations
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/dockerscan/">
            
              DockerScan
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/dive/">
            
              Dive
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity/docker-events/">
            
              Docker events
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity//">
            
              
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity//">
            
              
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity//">
            
              
            
          </a>

        
          
          <a class="sidebar-link " href="/containersecurity//">
            
              
            
          </a>

        
  </div>
</aside>
  
  <main>
    <article id="article">
      <nav id="article-nav">
  <button id="article-nav-menu-btn"><i class="icon icon-menu"></i> On this section</button>
  <button id="article-nav-toc-btn"><i class="icon icon-toc"></i> On this page</button>
</nav>
      <header id="article-header">
  <h1>YaraHunter - Malware Scanner for Container Images</h1>
</header>
      <div id="article-content">
        
        
        <h2 id="what-is-yara-">What is YARA ?</h2>
<p>YARA was originally developed by Victor Alvarez of VirusTotal and released on github in 2013 .</p>
<blockquote>
<p>YARA , the &ldquo;Pattern matching Swiss knife for malware researchers available on <a href="https://github.com/VirusTotal/yara" target="_blank">github</a></p>
</blockquote>
<h4 id="install-yara-on-mac">Install yara on Mac</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">brew install yara
</span></span></code></pre></div><h4 id="yara-is-extremely-popular-within-because-of-different-use-case-">Yara is extremely popular within because of different use case :</h4>
<ul>
<li>
<p>Identify and classify malware</p>
</li>
<li>
<p>Find new samples based on family-specific pattern</p>
</li>
<li>
<p>Deploy Yara Rules to identify samples and compromised device for incident response</p>
</li>
</ul>
<h4 id="why-yara-">Why Yara ?</h4>
<ul>
<li>
<p>Before Yara it was difficult for malware researcher To detect and classify large volumes of malware samples</p>
</li>
<li>
<p>can effective be used of hunting evolving malwares</p>
</li>
<li>
<p>Since Yara Rules are completely base on text , using an easy to understand syntax , they can be developed quickly</p>
</li>
</ul>
<h2 id="how-to-write-custom-detection-in-yara">How to write custom detection in YARA</h2>
<ol>
<li>
<p>Start of the rule: Every YARA rule should be declared by using the keyword rule followed by an identifier , or unique rule would like to give your rule</p>
</li>
<li>
<p>Add your meta section : the meta section can be used to provide comments or details about your rule information provided under meta will not be used for any variation of malware detection</p>
</li>
<li>
<p>Declare string : this is where you can declare a variable and set it value each variable is indicated using $ sign followed by the variable name</p>
</li>
<li>
<p>add your condition section : the condition section is where the rule declares what conditions must be met in order to rule to trigger a match .</p>
</li>
</ol>
<h3 id="my-first-yara-rule">my first yara rule</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">rule Hello_World
</span></span><span class="line"><span class="cl">  {
</span></span><span class="line"><span class="cl">          condition:
</span></span><span class="line"><span class="cl">                  true
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></div><p>verify yara is installed or not</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">yara --help
</span></span><span class="line"><span class="cl">YARA 4.2.3, the pattern matching swiss army knife.
</span></span><span class="line"><span class="cl">Usage: yara [OPTION]... [NAMESPACE:]RULES_FILE... FILE | DIR | PID
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Mandatory arguments to long options are mandatory for short options too.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       --atom-quality-table=FILE           path to a file with the atom quality table
</span></span><span class="line"><span class="cl">  -C,  --compiled-rules                    load compiled rules
</span></span><span class="line"><span class="cl">  -c,  --count                             print only number of matches
</span></span><span class="line"><span class="cl">  -d,  --define=VAR=VALUE                  define external variable
</span></span><span class="line"><span class="cl">       --fail-on-warnings                  fail on warnings
</span></span><span class="line"><span class="cl">  -f,  --fast-scan                         fast matching mode
</span></span><span class="line"><span class="cl">  -h,  --help                              show this help and exit
</span></span><span class="line"><span class="cl">  -i,  --identifier=IDENTIFIER             print only rules named IDENTIFIER
</span></span><span class="line"><span class="cl">       --max-process-memory-chunk=NUMBER   set maximum chunk size while reading process memory (default=1073741824)
</span></span><span class="line"><span class="cl">  -l,  --max-rules=NUMBER                  abort scanning after matching a NUMBER of rules
</span></span><span class="line"><span class="cl">       --max-strings-per-rule=NUMBER       set maximum number of strings per rule (default=10000)
</span></span><span class="line"><span class="cl">  -x,  --module-data=MODULE=FILE           pass FILE&#39;s content as extra data to MODULE
</span></span><span class="line"><span class="cl">  -n,  --negate                            print only not satisfied rules (negate)
</span></span><span class="line"><span class="cl">  -N,  --no-follow-symlinks                do not follow symlinks when scanning
</span></span><span class="line"><span class="cl">  -w,  --no-warnings                       disable warnings
</span></span><span class="line"><span class="cl">  -m,  --print-meta                        print metadata
</span></span><span class="line"><span class="cl">  -D,  --print-module-data                 print module data
</span></span><span class="line"><span class="cl">  -e,  --print-namespace                   print rules&#39; namespace
</span></span><span class="line"><span class="cl">  -S,  --print-stats                       print rules&#39; statistics
</span></span><span class="line"><span class="cl">  -s,  --print-strings                     print matching strings
</span></span><span class="line"><span class="cl">  -L,  --print-string-length               print length of matched strings
</span></span><span class="line"><span class="cl">  -g,  --print-tags                        print tags
</span></span><span class="line"><span class="cl">  -r,  --recursive                         recursively search directories
</span></span><span class="line"><span class="cl">       --scan-list                         scan files listed in FILE, one per line
</span></span><span class="line"><span class="cl">  -z,  --skip-larger=NUMBER                skip files larger than the given size when scanning a directory
</span></span><span class="line"><span class="cl">  -k,  --stack-size=SLOTS                  set maximum stack size (default=16384)
</span></span><span class="line"><span class="cl">  -t,  --tag=TAG                           print only rules tagged as TAG
</span></span><span class="line"><span class="cl">  -p,  --threads=NUMBER                    use the specified NUMBER of threads to scan a directory
</span></span><span class="line"><span class="cl">  -a,  --timeout=SECONDS                   abort scanning after the given number of SECONDS
</span></span><span class="line"><span class="cl">  -v,  --version                           show version information
</span></span></code></pre></div><h4 id="now-let-the-computer-greet-you">Now let the computer greet you:</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">$ yara hello.yara /yara/malware/somefile.txt
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">rule GoodMorning
</span></span><span class="line"><span class="cl">  {
</span></span><span class="line"><span class="cl">          condition:
</span></span><span class="line"><span class="cl">                hour &lt; 12 and hour &gt;= 4
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></div><h4 id="now-let-the-computer-greet-you-1">Now let the computer greet you:</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">yara hello.yara -d hour=11 ./yara/malware/somefile.txt
</span></span><span class="line"><span class="cl">GoodMorning ./yara/malware/somefile.txt
</span></span></code></pre></div><h4 id="structure-of-yara-rule-file">structure of YARA rule file</h4>
<p>rule RULE_NAME { // Rule definition goes here! // Comments in Yara rules look like this! }</p>
<p>The ‚Äúmeta‚Äù section of a rule contains the description, author, reference, date, hash, and any other relevant details of the rule. This section is optional and will not be used to classify malware. <code>meta: description = &quot;This is just an example&quot; threat_level = 3 in_the_wild = true</code></p>
<p>The ‚Äústrings‚Äù section contains string patterns that are used to identify malware. Each string in the ‚Äústrings‚Äù section is identified with a variable name starting with a dollar sign.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl">strings:
</span></span><span class="line"><span class="cl">       $a = {6A 40 68 00 30 00 00 6A 14 8D 91}
</span></span><span class="line"><span class="cl">       $b = {8D 4D B0 2B C1 83 C0 27 99 6A 4E 59 F7 F9}
</span></span><span class="line"><span class="cl">       $c = &#34;UVODFRYSIHLNWPEJXQZAKCBGMT&#34;
</span></span></code></pre></div><p>You should put signature strings that are indicative of the malware here. This example uses hex strings and text strings. But you can also use regex patterns. <code>strings: $a = {6A 40 68 00 30 00 00 6A 14 8D 91} // Hex strings are enclosed within curly brackets. $b = &quot;UVODFRYSIHLNWPEJXQZAKCBGMT&quot; // Plain text strings are enclosed within double quotes. $c = /md5: [0-9a-fA-F]{32}/ // Regex patterns are enclosed within slashes.</code> Finally, the ‚Äúcondition‚Äù section describes how the string patterns in the ‚Äústrings‚Äù section should be used to identify a piece of malware. You can use boolean (and, or, not), relational (&gt;, &lt;, =, and more), and arithmetic (+, -, *, /, %) expressions in this section. In our example, the rule specifies that if one of the strings $a, $b, or $c is present, the file is a silent banker trojan. <code>condition: $a or $b or $c</code> You can also define more complicated conditions like these. ``` condition: #a &gt; 2 and $b // If $a occurs more than twice and if $b is present</p>
<p>condition: ($a and $b) or ($b and $c) // If both $a and $b are present, or both $b and $c are present ```</p>
<h2 id="lets-bring-malware-scanner-for-cloud-native-as-part-of-cicd-and-at-runtime">Lets Bring Malware scanner for cloud-native, as part of CI/CD and at Runtime</h2>
<p>Deepfence&rsquo;s <a href="https://github.com/deepfence/YaraHunter">YaraHunter</a> - scans container images, running Docker containers, and filesystems to find indicators of malware. It uses a <a href="https://github.com/deepfence/yara-rules/blob/main/malware.yar" target="_blank">YARA ruleset</a> to identify resources that match known malware signatures, and may indicate that the container or filesystem has been compromised.</p>
<h3 id="yaradare-can-be-used-to-detect-malware-in-cloud-native-applications-in-the-following-ways">YaRadare can be used to detect malware in cloud-native applications in the following ways:</h3>
<ul>
<li>
<p>At rest: scan local container images, before they are deployed, to verify they do not contain malware</p>
</li>
<li>
<p>At runtime: scan running docker containers, if, for example, you observe unusual network traffic or CPU activity</p>
</li>
<li>
<p>Against filesystems: at any time, YaRadare can scan a local directory or filesystem for indicators of compromise</p>
</li>
</ul>
<p>we all build and scan images but we never take look at malware that packaged inside container or even file system YaraHunter can hunt malware that present at your docker images or Kubernetes cluster or you can use in CI/CD pipeline</p>
<h4 id="pull-image-you-want-to-scan">pull image you want to scan</h4>
<p>Images may be compromised with the installation of a cryptominer such as XMRig. In the following example, we&rsquo;ll scan a legitimiate cryptominer image that contains the same xmrig software that is often installed through an exploit:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-plaintext" data-lang="plaintext"><span class="line"><span class="cl"> docker pull metal3d/xmrig
</span></span></code></pre></div><h4 id="run-yarahunter-as-docker-container-and-get-result-in-json">Run YaraHunter as Docker Container and get result in json</h4>
<p><img src="https://raw.githubusercontent.com/deepfence/YaraHunter/main/docs/docs/yarahunter/img/yarahunter.svg" alt=""></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run -it --rm --name<span class="o">=</span>deepfence-yarahunter  
</span></span><span class="line"><span class="cl"><span class="se">\-</span>v /var/run/docker.sock:/var/run/docker.sock  
</span></span><span class="line"><span class="cl"><span class="se">\-</span>v /tmp:/home/deepfence/output  
</span></span><span class="line"><span class="cl">deepfenceio/yara-hunter:latest --image-name metal3d/xmrig:latest  
</span></span><span class="line"><span class="cl"><span class="se">\-</span>-json-filename<span class="o">=</span>xmrig-scan.json
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Using default tag: latest latest: Pulling from metal3d/xmrig 2408cc74d12b: Pull <span class="nb">complete</span> 75fcf72b2223: Pull <span class="nb">complete</span> 4e7c4ed53fb2: Pull <span class="nb">complete</span> Digest: sha256:c3c27a8b2f6beede6d9c0a7e5b79bb7a7b0002cca40565e7bfd2e447f3a2a628 Status: Downloaded newer image <span class="k">for</span> metal3d/xmrig:latest docker.io/metal3d/xmrig:latest WARNING: The requested image<span class="s1">&#39;s platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested INFO\[2022-09-09 00:53:43\] trying to connect to endpoint &#39;</span>unix:///var/run/docker.sock<span class="s1">&#39; with timeout &#39;</span>10s<span class="s1">&#39; INFO\[2022-09-09 00:53:43\] connected successfully using endpoint: unix:///var/run/docker.sock INFO\[2022-09-09 00:53:43\] trying to connect to endpoint &#39;</span>unix:///run/containerd/containerd.sock<span class="s1">&#39; with timeout &#39;</span>10s<span class="s1">&#39; WARN\[2022-09-09 00:53:53\] could not connect to endpoint &#39;</span>unix:///run/containerd/containerd.sock<span class="s1">&#39;: context deadline exceeded INFO\[2022-09-09 00:53:53\] trying to connect to endpoint &#39;</span>unix:///run/k3s/containerd/containerd.sock<span class="s1">&#39; with timeout &#39;</span>10s<span class="s1">&#39; WARN\[2022-09-09 00:54:03\] could not connect to endpoint &#39;</span>unix:///run/k3s/containerd/containerd.sock<span class="s1">&#39;: context deadline exceeded INFO\[2022-09-09 00:54:03\] container runtime detected: docker  
</span></span></span><span class="line"><span class="cl"><span class="s1">{ &#34;Timestamp&#34;: &#34;2022-09-09 00:54:27.639796179 +00:00&#34;, &#34;Image Name&#34;: &#34;metal3d/xmrig:latest&#34;, &#34;Image ID&#34;: &#34;a01f1ffa6691423ef43bfaee2a9c9f30fe08ee6df8d9d6586ae9692d90789c5a&#34;, &#34;Malware match detected are&#34;: \[ { &#34;Image Layer ID&#34;: &#34;bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789&#34;, &#34;Matched Rule Name&#34;: &#34;XMRIG\_Miner&#34;, &#34;Strings to match are&#34;: \[ &#34;stratum+tcp&#34; \], &#34;Category&#34;: \[\], &#34;File Name&#34;: &#34;/tmp/Deepfence/YaRadare/df\_metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/usr/local/bin/xmrig&#34;, &#34;ref&#34;:&#34;https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e &#34;, &#34;Summary&#34;: &#34;The matched rule file&#39;</span>s ref is https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e .<span class="s2">&#34; } , { &#34;</span>Image Layer ID<span class="s2">&#34;: &#34;</span>bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789<span class="s2">&#34;, &#34;</span>Matched Rule Name<span class="s2">&#34;: &#34;</span>XMRIG<span class="se">\_</span>Miner<span class="s2">&#34;, &#34;</span>Strings to match are<span class="s2">&#34;: \[ &#34;</span>stratum+tcp<span class="s2">&#34; \], &#34;</span>Category<span class="s2">&#34;: \[\], &#34;</span>File Name<span class="s2">&#34;: &#34;</span>/tmp/Deepfence/YaRadare/df<span class="se">\_</span>metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/xmrig-6.18.0/build/CMakeFiles/xmrig.dir/src/base/net/stratum/Url.cpp.o<span class="s2">&#34;, &#34;</span>ref<span class="s2">&#34;:&#34;</span>https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e <span class="s2">&#34;, &#34;</span>Summary<span class="s2">&#34;: &#34;</span>The matched rule file<span class="s1">&#39;s ref is https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e .&#34; } , { &#34;Image Layer ID&#34;: &#34;bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789&#34;, &#34;Matched Rule Name&#34;: &#34;Cerberus&#34;, &#34;Strings to match are&#34;: \[ &#34;cerberus&#34; \], &#34;Category&#34;: \[&#34;RAT&#34;,&#34;memory&#34;\], &#34;File Name&#34;: &#34;/tmp/Deepfence/YaRadare/df\_metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/xmrig-6.18.0/src/3rdparty/fmt/README.rst&#34;, &#34;description&#34;:&#34;Cerberus &#34;, &#34;author&#34;:&#34;Jean-Philippe Teissier / @Jipe\_ &#34;, &#34;date&#34;:&#34;2013-01-12 &#34;, &#34;filetype&#34;:&#34;memory &#34;, &#34;version&#34;:&#34;1.0 &#34;, &#34;Summary&#34;: &#34;The file /tmp/Deepfence/YaRadare/df\_metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/xmrig-6.18.0/src/3rdparty/fmt/README.rst has a memory match.The file has a rule match that Cerberus .The matched rule file&#39;</span>s author is Jean-Philippe Teissier / @Jipe<span class="se">\_</span> .The matched rule file<span class="s1">&#39;s date is 2013-01-12 .The matched rule file&#39;</span>s filetype is memory .The matched rule file<span class="s1">&#39;s version is 1.0 .&#34; } , { &#34;Image Layer ID&#34;: &#34;bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789&#34;, &#34;Matched Rule Name&#34;: &#34;XMRIG\_Miner&#34;, &#34;Strings to match are&#34;: \[ &#34;stratum+tcp&#34; \], &#34;Category&#34;: \[\], &#34;File Name&#34;: &#34;/tmp/Deepfence/YaRadare/df\_metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/xmrig-6.18.0/src/base/net/stratum/Url.cpp&#34;, &#34;ref&#34;:&#34;https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e &#34;, &#34;Summary&#34;: &#34;The matched rule file&#39;</span>s ref is https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e .<span class="s2">&#34; } , { &#34;</span>Image Layer ID<span class="s2">&#34;: &#34;</span>bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789<span class="s2">&#34;, &#34;</span>Matched Rule Name<span class="s2">&#34;: &#34;</span>XMRIG<span class="se">\_</span>Miner<span class="s2">&#34;, &#34;</span>Strings to match are<span class="s2">&#34;: \[ &#34;</span>stratum+tcp<span class="s2">&#34; \], &#34;</span>Category<span class="s2">&#34;: \[\], &#34;</span>File Name<span class="s2">&#34;: &#34;</span>/tmp/Deepfence/YaRadare/df<span class="se">\_</span>metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/usr/local/bin/xmrig<span class="s2">&#34;, &#34;</span>ref<span class="s2">&#34;:&#34;</span>https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e <span class="s2">&#34;, &#34;</span>Summary<span class="s2">&#34;: &#34;</span>The matched rule file<span class="s1">&#39;s ref is https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e .&#34; } , { &#34;Image Layer ID&#34;: &#34;bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789&#34;, &#34;Matched Rule Name&#34;: &#34;XMRIG\_Miner&#34;, &#34;Strings to match are&#34;: \[ &#34;stratum+tcp&#34; \], &#34;Category&#34;: \[\], &#34;File Name&#34;: &#34;/tmp/Deepfence/YaRadare/df\_metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/xmrig-6.18.0/build/CMakeFiles/xmrig.dir/src/base/net/stratum/Url.cpp.o&#34;, &#34;ref&#34;:&#34;https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e &#34;, &#34;Summary&#34;: &#34;The matched rule file&#39;</span>s ref is https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e .<span class="s2">&#34; } , { &#34;</span>Image Layer ID<span class="s2">&#34;: &#34;</span>bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789<span class="s2">&#34;, &#34;</span>Matched Rule Name<span class="s2">&#34;: &#34;</span>Cerberus<span class="s2">&#34;, &#34;</span>Strings to match are<span class="s2">&#34;: \[ &#34;</span>cerberus<span class="s2">&#34; \], &#34;</span>Category<span class="s2">&#34;: \[&#34;</span>RAT<span class="s2">&#34;,&#34;</span>memory<span class="s2">&#34;\], &#34;</span>File Name<span class="s2">&#34;: &#34;</span>/tmp/Deepfence/YaRadare/df<span class="se">\_</span>metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/xmrig-6.18.0/src/3rdparty/fmt/README.rst<span class="s2">&#34;, &#34;</span>description<span class="s2">&#34;:&#34;</span>Cerberus <span class="s2">&#34;, &#34;</span>author<span class="s2">&#34;:&#34;</span>Jean-Philippe Teissier / @Jipe<span class="se">\_</span> <span class="s2">&#34;, &#34;</span>date<span class="s2">&#34;:&#34;</span>2013-01-12 <span class="s2">&#34;, &#34;</span>filetype<span class="s2">&#34;:&#34;</span>memory <span class="s2">&#34;, &#34;</span>version<span class="s2">&#34;:&#34;</span>1.0 <span class="s2">&#34;, &#34;</span>Summary<span class="s2">&#34;: &#34;</span>The file /tmp/Deepfence/YaRadare/df<span class="se">\_</span>metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/xmrig-6.18.0/src/3rdparty/fmt/README.rst has a memory match.The file has a rule match that Cerberus .The matched rule file<span class="s1">&#39;s author is Jean-Philippe Teissier / @Jipe\_ .The matched rule file&#39;</span>s date is 2013-01-12 .The matched rule file<span class="s1">&#39;s filetype is memory .The matched rule file&#39;</span>s version is 1.0 .<span class="s2">&#34; } , { &#34;</span>Image Layer ID<span class="s2">&#34;: &#34;</span>bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789<span class="s2">&#34;, &#34;</span>Matched Rule Name<span class="s2">&#34;: &#34;</span>XMRIG<span class="se">\_</span>Miner<span class="s2">&#34;, &#34;</span>Strings to match are<span class="s2">&#34;: \[ &#34;</span>stratum+tcp<span class="s2">&#34; \], &#34;</span>Category<span class="s2">&#34;: \[\], &#34;</span>File Name<span class="s2">&#34;: &#34;</span>/tmp/Deepfence/YaRadare/df<span class="se">\_</span>metal3dxmriglatest/ExtractedFiles/bad74b706fcd3e01f4af74337744cbcc84ab60da82c40dd588469c6360258789/xmrig-6.18.0/src/base/net/stratum/Url.cpp<span class="s2">&#34;, &#34;</span>ref<span class="s2">&#34;:&#34;</span>https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e <span class="s2">&#34;, &#34;</span>Summary<span class="s2">&#34;: &#34;</span>The matched rule file<span class="err">&#39;</span>s ref is https://gist.github.com/GelosSnake/c2d4d6ef6f93ccb7d3afb5b1e26c7b4e .<span class="s2">&#34; }
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">\] }
</span></span></span></code></pre></div><p>Check it out YaraHunter and support this project by giving gitstar !</p>
<p><a href="https://github.com/deepfence/YaraHunter"><img src="https://github-readme-stats.vercel.app/api/pin/?username=deepfence&amp;repo=YaraHunter" alt="Readme Card" target="_blank"></a></p>

      </div>
      








  
  
  
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

        
          
        

      
    
        

      
    
        

        
          
        

        
        


<footer id="article-footer">
  <time id="article-last-updated" datetime="2023-11-26"><i class="icon icon-calendar"></i>&nbsp;Last updated: 2023-11-26</time>

  
    <a id="article-prev-link" href="/containersecurity/secretscanner-finding-secrets-and-passwords-in-container-images-and-file-systems/"><i class="icon icon-prev icon-colored"></i> Prev</a>
  

  
    <a id="article-next-link"  href="/containersecurity/security-linting-of-dockerfiles/">Next <i class="icon icon-next icon-colored"></i></a>
  
</footer>
    </article>
    <aside id="toc">
  <span class="btn-close"><i class="icon icon-close"></i></span>
  <div class="sticky">
    <strong><i class="icon icon-toc"></i> On this page</strong>
    <nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-yara-">What is YARA ?</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#how-to-write-custom-detection-in-yara">How to write custom detection in YARA</a>
      <ul>
        <li><a href="#my-first-yara-rule">my first yara rule</a></li>
      </ul>
    </li>
    <li><a href="#lets-bring-malware-scanner-for-cloud-native-as-part-of-cicd-and-at-runtime">Lets Bring Malware scanner for cloud-native, as part of CI/CD and at Runtime</a>
      <ul>
        <li><a href="#yaradare-can-be-used-to-detect-malware-in-cloud-native-applications-in-the-following-ways">YaRadare can be used to detect malware in cloud-native applications in the following ways:</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</aside>
  </main>
</div>

    <footer id="site-footer">
  
  <div id="site-footer-copyright">
    <a href="https://discord.gg/rEvr7vq" target="_blank">
      <i class="icon icon-copyright"></i> 2023 CloudNativeFolks
    </a>
  </div>

  
  <div id="site-footer-social">

    

    
    <a href="https://twitter.com/i/communities/1499311438745468931" target="_blank" aria-label="twitter url">
      <i class="icon icon-twitter icon-colored"></i>
    </a>
    

    
    <a href="https://github.com/sangam14" target="_blank" aria-label="github url">
      <i class="icon icon-github icon-colored"></i>
    </a>
    

    
    <a href="https://www.youtube.com/@CloudNativeFolks" target="_blank" aria-label="youtube url">
      <i class="icon icon-youtube icon-colored"></i>
    </a>
    

  </div>

  
  <center> <a href="https://visitorbadge.io/status?path=https%3A%2F%2Fkubedaily.com"><img src="https://api.visitorbadge.io/api/visitors?path=https%3A%2F%2Fkubedaily.com&label=KubeDaily&labelColor=%232ccce4&countColor=%2337d67a" /></a> </center> 

  
  <div id="site-footer-love">
    Made with <i class="icon icon-love icon-colored"></i> &nbsp;from&nbsp;<a href="https://blog.cloudnativefolks.org" target="_blank">@CloudNativeFollks</a>
  </div>
</footer>
    






<script type="text/javascript" src="/js/base.min.js"></script>



  
  <script src="/js/component/docsearch.min.js"></script>
  <script type="application/javascript">
      docsearch({
          container: '#site-header-search',
          appId: '',
          indexName: '',
          apiKey: '',
      });
  </script>


<script type="application/javascript">
    if('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sw.js?2023-12-03')
            .catch(function(err) {console.error('ServiceWorker registration failed: ', err);});
    }
</script>
  </body>
</html>